<div class="min-h-screen flex flex-col bg-stone-50 dark:bg-stone-950 transition-colors duration-500">
    <!-- ── Header ──────────────────────────────────────────────────── -->
    <header
        class="sticky top-0 z-50 flex items-center justify-between gap-3 px-4 sm:px-6 py-4 sm:py-3 bg-white/70 dark:bg-stone-900/70 backdrop-blur-xl border-b border-stone-100 dark:border-stone-800 shadow-sm shadow-stone-200/20 dark:shadow-stone-950/20 supports-backdrop-filter:bg-white/60"
    >
        <!-- Logo: solo visible en sm+ -->
        <div class="hidden sm:flex items-center gap-3">
            <div class="flex items-center -space-x-1">
                <div
                    class="p-2 bg-orange-100 dark:bg-orange-900/30 rounded-xl z-10 ring-2 ring-white dark:ring-stone-900 transform rotate-3"
                >
                    <lucide-angular [img]="Coffee" [size]="18" strokeWidth="2.5" class="text-orange-500 dark:text-orange-300" />
                </div>
                <div class="p-2 bg-rose-100 dark:bg-rose-900/30 rounded-xl ring-2 ring-white dark:ring-stone-900 transform -rotate-3">
                    <lucide-angular [img]="Spade" [size]="18" strokeWidth="2.5" class="text-rose-500 dark:text-rose-300" />
                </div>
            </div>
            <span class="text-lg font-black text-stone-700 dark:text-stone-200 tracking-tight">
                Pomo<span class="text-orange-500 dark:text-orange-400">Ludo</span>
            </span>
        </div>

        <!-- Nav tabs -->
        <nav class="flex justify-start gap-2" aria-label="Secciones">
            <button
                ngpButton
                (click)="activeSection.set('pomodoro')"
                [attr.aria-current]="activeSection() === 'pomodoro' ? 'page' : null"
                [class]="pomodoroTabClass()"
            >
                <lucide-angular [img]="Timer" [size]="20" strokeWidth="2.5" />
                <span class="hidden sm:inline font-bold">Pomodoro</span>
            </button>
            <button
                ngpButton
                (click)="activeSection.set('blackjack')"
                [attr.aria-current]="activeSection() === 'blackjack' ? 'page' : null"
                [class]="blackjackTabClass()"
            >
                <lucide-angular [img]="Spade" [size]="20" strokeWidth="2.5" />
                <span class="hidden sm:inline font-bold">Blackjack</span>
            </button>
        </nav>

        <!-- Right side -->
        <div class="flex items-center justify-end gap-2 sm:gap-3 min-w-0">
            <!-- Chips badge: Solo icono en móvil, completo en desktop -->
            <div
                class="flex items-center gap-2 px-2 py-1.5 sm:px-3 rounded-full shadow-sm bg-amber-100/60 dark:bg-amber-900/40 border border-amber-200 dark:border-amber-700/50 hover:scale-105 transition-transform cursor-help"
                title="Tus fichas ganadas"
            >
                <div class="p-1 bg-amber-200 dark:bg-amber-700/50 rounded-full">
                    <lucide-angular [img]="Coins" [size]="14" strokeWidth="2.5" class="text-amber-700 dark:text-amber-200" />
                </div>
                <span class="text-sm font-extrabold text-amber-700 dark:text-amber-200 pr-1">
                    {{ userService.chips() }}
                </span>
            </div>

            <!-- Username: Visible también en móvil -->
            <span
                class="flex items-center gap-2 px-2 py-1.5 sm:px-3 rounded-full shadow-sm bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 text-sm font-bold text-stone-600 dark:text-stone-300 max-w-20 sm:max-w-32 truncate select-none"
            >
                <div class="p-1 bg-orange-100 dark:bg-orange-900/50 rounded-full hidden xs:block">
                    <lucide-angular [img]="BookOpen" [size]="14" strokeWidth="2.5" class="text-orange-500 dark:text-orange-300" />
                </div>
                <span class="truncate">{{ userService.name() }}</span>
            </span>

            <div class="h-6 w-px bg-stone-200 dark:bg-stone-800 mx-1 hidden sm:block"></div>

            <!-- Theme toggle -->
            <button
                ngpButton
                (click)="themeService.toggle()"
                aria-label="Cambiar tema"
                class="p-2 rounded-full cursor-pointer text-stone-500 dark:text-stone-400 bg-transparent hover:bg-stone-100 dark:hover:bg-stone-800 hover:text-orange-500 dark:hover:text-amber-300 transition-all duration-300 active:scale-90"
            >
                @if (themeService.isDark()) {
                    <lucide-angular [img]="Sun" [size]="20" strokeWidth="2" />
                } @else {
                    <lucide-angular [img]="Moon" [size]="20" strokeWidth="2" />
                }
            </button>

            <!-- Logout -->
            <button
                ngpButton
                (click)="logout()"
                aria-label="Cerrar sesión"
                class="p-2 rounded-full cursor-pointer text-stone-400 dark:text-stone-500 hover:bg-rose-50 dark:hover:bg-rose-950/30 hover:text-rose-500 dark:hover:text-rose-400 transition-all duration-300 active:scale-90"
                title="Cerrar sesión"
            >
                <lucide-angular [img]="LogOut" [size]="20" strokeWidth="2.5" />
            </button>
        </div>
    </header>

    <!-- ── Main ─────────────────────────────────────────────────────── -->
    <main [class]="mainClass()">
        @if (activeSection() === 'pomodoro') {
            <app-pomodoro-timer />
        }

        @if (activeSection() === 'blackjack') {
            <app-blackjack />
        }
    </main>
</div>
